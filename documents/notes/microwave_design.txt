
In order to satisfy the Barkhausen condition for oscillation, a 180 degree phase shift is required 
in the feedback loop. The inverting mosfet itself contributes the remaining 180 degrees.

The S-parameters for the CE3520K3 mosfet are listed on the manufacturer's webpage. 

qucs-RFlayout didn't recognize the QUCS file until the version ("0.0.19") was added to the
opening XML tag. #5.

----------------------------------------------------------------------------

Because of the small engraving bit diameter, we would like to etch a minimum amount of copper.

Microwaves101 says clearance of 3 line widths,
but Digi says clearance of 2 x substrate thickness.

To be safe, we'll go for 5x0.8, or 4 mm clearance.

-------------------------------------------------------------------------------------

A matching network isn't strictly necessary if the gain and VSWR are already satisfactory [mwrf]. 
The S-parameters provided by the manufacturer are given relative to a 50-ohm impedance. 

The S-parameter table shows us that at 8 GHz, the transistor does not produce the 180 degree phase
shift that was expected. The S21 mag,angle (@2v, 50 Ohm, 10 ma) varies from 4.7, 149 deg at 2 GHz to 
4.1, 62 deg at 8 GHz.

That's a clue as to why the most recent LO test didn't work.

Designing the feedback loop would be helped by some optimization, so the Qucs ASCO 4.10 optimizer 
is used. Needed to be patched: https://github.com/Qucs/qucs/issues/861

An AC sim was used in QUCS, with the F interval set to the desired interval.

Unfortunately, the gain isn't particularly satisfactory - the input of the device seems to be 
poorly matched to the output. Or perhaps this is just an artifact of the frequency-dependent 
impedance of the microstrips?

Au contrare. 

Qucs doesn't allow variables as filenames.


Simply teeing the output and feedback on the stage 1 oscillator does work, but if the 


-------------------------------------------------------------------------------------

The SMV1249 varactor in SC-79 (SOD-523) has an inductance of 0.7 nF.

----------------

IF out on the HMC220B should be AC coupled.

    
                  
      |--------------------| 6GHz                      || HackRF spectrum 
1 MHz |--------------------------------------| 12 GHz  ||
                 5 GHz |---------------------| 12 GHz  || Spectrum of interest

      |------------| 4 GHz                             || HMC220B IF range
                 5 GHz |---------------------| 12 GHz  || HMC220B RF range



---------------


Designed qucs loop into kicad. Upgraded kicad to 5.1.5 through dpkg for rounded edges.
Spacebar origin reset is very helpful.


Assembled local_oscillator.kicad. Apparent 9 ohm short across power and gnd, but ended up being
just the normal mosfet resistance. 

Refused to start up until the wires were jiggled, the voltage was increased to 2.3 V, and the current
to 0.025 A. Resonates at 5.75 GHz. Slightly affected by proximity.

There is considerable instability, however. Applying some voltage to the varactor instantly kills the
signal, no matter the osc. bias.

This is a "parallel feedback loop oscillator". 

That was with a 50 R termination on the output. Removing that dropped Fres to 5.6 GHz.

Tried putting a 30 K resistor on the gate to keep the gate bias from floating away. Refused to start
up.

Tried removing the DC block from varactor to gate, to use the existing bias trace to hold down the gate.
Putting a big solder blob on there seemed to prevent it from starting up - 
except later, I saw that when starting with 0.02 A, it steady-state transmits at 0.6V, rather than
the previous 2.3 V. 

There are a bunch of spurious tones, but the main one is much stronger than before - maybe 10x.

It's also more stable. F is still basically the same, 5.8 GHz.

Oh, putting an inductor in the alternate fb loop makes a massive difference.

Even though the OP power is only about -40 DB, the downconverter seems to be operational.

It's hard to tell what the pin diode is doing. Once the resistance is brought down a bit,
the oscillation voltage increases to 1.8v from 0.9, and all tones disappear from downconverter.
 At 0.3 A on the pin diode, the signal returns.


Huh. Is that an effect of the increased inductance to ground?

Exchanged the pin diode for a varactor. The entire spectrum lit up with -10 db signals. 

The current (and, presumably, frequency) actually tracks the HackRF LO sweep!, varying by 5% or so!

Varactor produces a very monotonic shift in F of 500 MHz over 5 V.

Ooh, all sorts of diodes exibit "varicap-like" behavior! Fantastic.

Oh, of course - the varactor isn't being biased above the amplitude, so it's going crazy.

Aha! for stability, the filter (for frequency response) and the phase shift should be optimized seperately.

"Mode hopping" - that's what the pin diode causes. No VCO-like behavior.
-

The thin 6mm FB-reflecting trace seems to actually cause a lot of problems - adds a second pole

Can use PIN diodes as a comb generator

The filter should be sharper to reject alternate modes. Proximity effect could be used to disable
osc. when too close to body?

0.2 mm x 3 mm biasing lines make a significant difference.


HOLD up! We don't need to sweep the LO - we can just use the images on the low side of the mixer
to catch the 4.5-LO GHz region! 

Our substrate thickness isn't conducive to the high-impedance choke traces needed.

I'm being very dumb. I've spent many days just trying different circuits out - learning, I suppose,
but also not being rigorous. There must be a way to design an oscillator piecewise, in a coherent 
fashion. For instance:

when a peak appears, I insert a filter. This changes the phase, so I try inserting a phase shifter-
but this introduces new resonances, etc, etc. This is no way to design a circuit.

[Wu 2013] use 100-ohm choke traces

why am I being so dumb.
 
Pretty sure the entire circuit is wrong. Most circuits have the frequency-determining component
on the drain or source. I can't model that in qucs using this S-param file.

So there's a very undesirable phase shift introduced with series capacitor at around 2-4 GHz.
This should cause ocillation at that frequency - fortunately, the gain of the amp
is very small at that F, so that should be rejected.

People have used varactors to tune across the entire frequency range, but that's pretty tricky

The capacitance of the RF Shottky diodes used varies from 0.28 to 0.22 pF. Most other diodes seem
to be around 10 pF, with the exception of a MMDL914, which goes from 0.62 to 0.55.

Hey, hang on a minute. The phase shift doesn't need to be 360 deg - it just needs to be a 
multiple of 360. As long as the FB filter response is correct, we can add phasing lines...

Loss tangent of substrate was wrong, too.

Had a quarter-wave notch filter that looked so wonderful - but one of the resonators was 100 mm long!

Quin [2017] use 51k ohm resistors as chokes at 1 GHz.

Neat construction of planar caps using mica insulators in Toyoda [1980]

A stepped-impedance tuned bandpass filter seems to be of reasonable dimensions at these frequencies.



https://forum.allaboutcircuits.com/threads/finding-power-levels-at-mixers-input.136016/
"The conversion gain, given in the datasheet, is the ratio of the power at the output to the power at the input. 
The conversion gain given in the datasheet for the LT5511 is 0dB. That means that the output power is equal to input power. 
it really couldn't be simpler. Where do integrals come into that?"

Admittance is just 1/inductance.

"documentation brigades" that trawl through scientific software repos, making notes on the theory behind
the software and providing usage and installation guides

Right now, getting a paper into a prestigious journal is linked with its "scientific quality",
perhaps partially because the peer-review process is integrated with the journal.
All of these incentives - grants, tenure, etc, is all linked with the name of the journal.

What if we made an independent peer-review system that fit into the preprint-server architecture?
Like, there's a peer-review ID that's added to the paper once it's peer-reviewed.

When writing long equations into python, comparing to the source using py2tex is extremely helpful.

SIR would probably have been better, due to the slightly better insertion loss and because of the pun.

The analytic comb version finally works; produces a very nicely tunable and very smooth filter.

Unfortunately, the phase shift is 
