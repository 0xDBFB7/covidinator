
In order to satisfy the Barkhausen condition for oscillation, a 180 degree phase shift is required 
in the feedback loop. The inverting mosfet itself contributes the remaining 180 degrees.

The S-parameters for the CE3520K3 mosfet are listed on the manufacturer's webpage. 

qucs-RFlayout didn't recognize the QUCS file until the version ("0.0.19") was added to the
opening XML tag. #5.

----------------------------------------------------------------------------

Because of the small engraving bit diameter, we would like to etch a minimum amount of copper.

Microwaves101 says clearance of 3 line widths,
but Digi says clearance of 2 x substrate thickness.

To be safe, we'll go for 5x0.8, or 4 mm clearance.

-------------------------------------------------------------------------------------

A matching network isn't strictly necessary if the gain and VSWR are already satisfactory [mwrf]. 
The S-parameters provided by the manufacturer are given relative to a 50-ohm impedance. 

The S-parameter table shows us that at 8 GHz, the transistor does not produce the 180 degree phase
shift that was expected. The S21 mag,angle (@2v, 50 Ohm, 10 ma) varies from 4.7, 149 deg at 2 GHz to 
4.1, 62 deg at 8 GHz.

That's a clue as to why the most recent LO test didn't work.

Designing the feedback loop would be helped by some optimization, so the Qucs ASCO 4.10 optimizer 
is used. Needed to be patched: https://github.com/Qucs/qucs/issues/861

An AC sim was used in QUCS, with the F interval set to the desired interval.

Unfortunately, the gain isn't particularly satisfactory - the input of the device seems to be 
poorly matched to the output. Or perhaps this is just an artifact of the frequency-dependent 
impedance of the microstrips?

Au contrare. 

Qucs doesn't allow variables as filenames.


Simply teeing the output and feedback on the stage 1 oscillator does work, but if the 


-------------------------------------------------------------------------------------

The SMV1249 varactor in SC-79 (SOD-523) has an inductance of 0.7 nF.

----------------

IF out on the HMC220B should be AC coupled.

    
                  
      |--------------------| 6GHz                      || HackRF spectrum 
1 MHz |--------------------------------------| 12 GHz  ||
                 5 GHz |---------------------| 12 GHz  || Spectrum of interest

      |------------| 4 GHz                             || HMC220B IF range
                 5 GHz |---------------------| 12 GHz  || HMC220B RF range



---------------


Designed qucs loop into kicad. Upgraded kicad to 5.1.5 through dpkg for rounded edges.
Spacebar origin reset is very helpful.


Assembled local_oscillator.kicad. Apparent 9 ohm short across power and gnd, but ended up being
just the normal mosfet resistance. 

Refused to start up until the wires were jiggled, the voltage was increased to 2.3 V, and the current
to 0.025 A. Resonates at 5.75 GHz. Slightly affected by proximity.

There is considerable instability, however. Applying some voltage to the varactor instantly kills the
signal, no matter the osc. bias.

This is a "parallel feedback loop oscillator". 

That was with a 50 R termination on the output. Removing that dropped Fres to 5.6 GHz.

Tried putting a 30 K resistor on the gate to keep the gate bias from floating away. Refused to start
up.

Tried removing the DC block from varactor to gate, to use the existing bias trace to hold down the gate.
Putting a big solder blob on there seemed to prevent it from starting up - 
except later, I saw that when starting with 0.02 A, it steady-state transmits at 0.6V, rather than
the previous 2.3 V. 

There are a bunch of spurious tones, but the main one is much stronger than before - maybe 10x.

It's also more stable. F is still basically the same, 5.8 GHz.

Oh, putting an inductor in the alternate fb loop makes a massive difference.

Even though the OP power is only about -40 DB, the downconverter seems to be operational.

It's hard to tell what the pin diode is doing. Once the resistance is brought down a bit,
the oscillation voltage increases to 1.8v from 0.9, and all tones disappear from downconverter.
 At 0.3 A on the pin diode, the signal returns.


Huh. Is that an effect of the increased inductance to ground?

Exchanged the pin diode for a varactor. The entire spectrum lit up with -10 db signals. 

The current (and, presumably, frequency) actually tracks the HackRF LO sweep!, varying by 5% or so!

Varactor produces a very monotonic shift in F of 500 MHz over 5 V.

Ooh, all sorts of diodes exibit "varicap-like" behavior! Fantastic.

Oh, of course - the varactor isn't being biased above the amplitude, so it's going crazy.

Aha! for stability, the filter (for frequency response) and the phase shift should be optimized seperately.

"Mode hopping" - that's what the pin diode causes. No VCO-like behavior.
-

The thin 6mm FB-reflecting trace seems to actually cause a lot of problems - adds a second pole

Can use PIN diodes as a comb generator